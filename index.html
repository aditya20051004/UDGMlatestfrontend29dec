<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FoodGPT 1.0</title>

  <style>
    * {
      box-sizing: border-box;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
    }



body {
  margin: 0;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  color: #eaeaf0;
  overflow-x: hidden;

  /* üé¨ CINEMATIC COLOR GRADE */
  background:
    radial-gradient(
      60% 60% at 15% 20%,
      rgba(130, 90, 255, 0.35),
      transparent 60%
    ),
    radial-gradient(
      50% 50% at 85% 25%,
      rgba(255, 140, 80, 0.25),
      transparent 60%
    ),
    radial-gradient(
      70% 70% at 70% 80%,
      rgba(80, 160, 255, 0.30),
      transparent 65%
    ),
    linear-gradient(
      180deg,
      #0a0c13 0%,
      #06070c 100%
    );
}
body::after {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;

  background:
    linear-gradient(
      180deg,
      rgba(255,255,255,0.03),
      rgba(0,0,0,0.35)
    );

  mix-blend-mode: overlay;
  opacity: 0.9;
}



    .brand {
      position: absolute;
      top: 22px;
      left: 28px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-text span {
      color: #9fa6ff;
    }

    .app {
      width: 90%;
      max-width: 720px;
      margin-top: 140px;
      padding: 32px;
      border-radius: 22px;
       background: rgba(20, 22, 40, 0.55);
       backdrop-filter: blur(18px);
      box-shadow:
       0 0 60px rgba(120, 140, 255, 0.18),
       inset 0 0 0 1px rgba(255,255,255,0.05);
    }

    textarea {
      width: 100%;
      margin-top: 14px;
      padding: 16px;
      min-height: 120px;
      border-radius: 14px;
      border: none;
      background: rgba(255, 255, 255, 0.06);
      color: white;
      resize: none;
    }

    .actions {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      margin-top: 18px;
    }

   button {
  padding: 10px 18px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  font-size: 0.9rem;
  
  background: linear-gradient(135deg, #8b7cff, #b58cff);
  box-shadow:
    0 0 20px rgba(140, 160, 255, 0.35),
    0 0 45px rgba(140, 160, 255, 0.25);


  
  

  transition:
    transform 0.15s ease,
    box-shadow 0.15s ease,
    filter 0.15s ease;
}

/* ‚ú® HOVER GLOW */
button:hover {
  transform: translateY(-1.5px);
  filter: brightness(1.1);

 
  box-shadow:
    0 0 30px rgba(160, 180, 255, 0.6),
    0 0 70px rgba(140, 160, 255, 0.45);
}



/* PRESS */
button:active {
  transform: translateY(0);
  box-shadow:
    0 0 18px rgba(120, 140, 255, 0.45);
}


    .response {
      margin-top: 30px;
      padding: 22px;
      border-radius: 18px;
      background: rgba(255, 255, 255, 0.05);
      display: none;
    }
    .confidence-wrap {
  margin-top: 16px;
}

.confidence-label {
  font-size: 0.75rem;
  color: #aeb2ff;
  margin-bottom: 6px;
  letter-spacing: 0.6px;
}

.confidence-bar {
  width: 100%;
  height: 8px;
  border-radius: 999px;
  background: rgba(255,255,255,0.08);
  overflow: hidden;
}

#confidenceFill {
  height: 100%;
  width: 0%;
  border-radius: 999px;
  background: linear-gradient(
    90deg,
    #ff6b6b,
    #ffd93d,
    #6bffb8
  );
  transition: width 0.6s ease;
}

.confidence-text {
  margin-top: 6px;
  font-size: 0.8rem;
  color: #b8bbd8;
}

.confidence-wrap {
  animation: fadeUp 0.6s ease forwards;
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}


    .section-title {
      font-size: 0.8rem;
      color: #aeb2ff;
    }

    .section-content {
      margin-bottom: 12px;
      font-size: 0.92rem;
    }

    .hidden {
      display: none;
    }

    .loading {
      margin-top: 20px;
      text-align: center;
      color: #eaeaea;
    }

    .spinner {
      width: 36px;
      height: 36px;
      margin: 0 auto 12px;
      border: 4px solid rgba(255,255,255,0.2);
      border-top: 4px solid #00ffcc;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .error {
      margin-top: 15px;
      color: #ff6b6b;
      text-align: center;
    }

    #cameraModal {
      display: none;
      margin-top: 14px;
    }

    video {
      width: 100%;
      border-radius: 14px;
      transform: scaleX(-1);
    }
    .author-inline {
      position: relative;
  margin-top: 5px;
  font-size: 1rem;
  color: #9fa6ff;
  opacity: 0.50;
}

  </style>
</head>

<body>

  <div class="brand">
    <div>üí™</div>
    <div class="brand-text">FoodGPT <span>1.0</span></div>
    <p class="author-inline">$_INDIANO_$</p>

  </div>

  <div class="app">
    <h1>Food Ingredient Copilot</h1>
    <p>Paste ingredients or scan a food label.</p>

    <textarea id="input" placeholder="e.g. wheat, sugar, palm oil"></textarea>

    <div class="actions">
      <button onclick="openCamera()">Open Camera</button>
      <button onclick="mockAnalyze()">Ask AI</button>
    </div>

    <!-- Loading -->
    <div id="loadingBox" class="loading hidden">
      <div class="spinner"></div>
      <p id="aiPhase" style="opacity:0.8;font-size:13px;"></p>
    </div>

    <!-- Error -->
    <div id="errorBox" class="error hidden"></div>

    <!-- Camera -->
    <div id="cameraModal">
      <video id="video" autoplay></video>
      <div class="actions">
        <button onclick="capturePhoto()">Capture</button>
        <button onclick="closeCamera()">Close</button>
      </div>
      <canvas id="canvas" class="hidden"></canvas>
    </div>
    <div class="confidence-wrap">
  <div class="confidence-label">AI Confidence</div>
  <div class="confidence-bar">
    <div id="confidenceFill"></div>
  </div>
  <div id="confidenceText" class="confidence-text"></div>
</div>

    <!-- Response -->
    <div id="response" class="response">
      <div><div class="section-title">WHAT MATTERS</div><div class="section-content"></div></div>
      <div><div class="section-title">WHY IT MATTERS</div><div class="section-content"></div></div>
      <div><div class="section-title">TRADE-OFFS</div><div class="section-content"></div></div>
      <div><div class="section-title">UNCERTAINTY</div><div class="section-content"></div></div>
      <div><div class="section-title">DECISION</div><div class="section-content"></div></div>
    </div>
  </div>
 



<script>
  let stream;
  window.capturedImage = null;

  async function openCamera() {
    stream = await navigator.mediaDevices.getUserMedia({ video: true });
    document.getElementById("video").srcObject = stream;
    document.getElementById("cameraModal").style.display = "block";
  }

  function capturePhoto() {
    const canvas = document.getElementById("canvas");
    const video = document.getElementById("video");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    const ctx = canvas.getContext("2d");
    ctx.translate(canvas.width, 0);
    ctx.scale(-1, 1);
    ctx.drawImage(video, 0, 0);

    window.capturedImage = canvas.toDataURL("image/png");
    closeCamera();
  }

  function closeCamera() {
    if (stream) stream.getTracks().forEach(t => t.stop());
    document.getElementById("cameraModal").style.display = "none";
  }
  

  async function mockAnalyze() {
    const input = document.getElementById("input").value;

    const responseBox = document.getElementById("response");
    const loadingBox = document.getElementById("loadingBox");
    const errorBox = document.getElementById("errorBox");

    responseBox.style.display = "none";
    errorBox.classList.add("hidden");
    loadingBox.classList.remove("hidden");
    // ---- AI thinking phases ----
const phases = [
  "Understanding ingredients‚Ä¶",
  "Checking health impact‚Ä¶",
  "Analyzing trade-offs‚Ä¶",
  "Preparing recommendation‚Ä¶"
];

let i = 0;
const phaseEl = document.getElementById("aiPhase");
phaseEl.innerText = phases[0];

const phaseTimer = setInterval(() => {
  phaseEl.innerText = phases[i++ % phases.length];
}, 1800);


    try {
      const res = await fetch("https://foodgptbackend-1.onrender.com/analyze", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          text: input,
          image: window.capturedImage
        })
      });

      if (!res.ok) throw new Error("Backend not responding");

      const data = await res.json();
      const sections = document.querySelectorAll(".section-content");

      sections[0].innerText = data.whatMatters || "-";
      sections[1].innerText = data.whyItMatters || "-";
      sections[2].innerText = data.tradeOffs || "-";
      sections[3].innerText = data.uncertainty || "-";
      sections[4].innerText = data.decision || "-";

      // ---- Confidence calculation (frontend heuristic) ----
let confidence = 0;

if (input.length > 20) confidence += 30;
if (input.split(",").length >= 3) confidence += 20;
if (window.capturedImage) confidence += 20;
if (!data.uncertainty || data.uncertainty.toLowerCase().includes("low"))
  confidence += 20;

confidence = Math.min(confidence, 95); // cap it

document.getElementById("confidenceFill").style.width = confidence + "%";

document.getElementById("confidenceText").innerText =
  confidence > 75
    ? "High confidence ‚Äî recommendation is reliable"
    : confidence > 45
    ? "Moderate confidence ‚Äî consider labels carefully"
    : "Low confidence ‚Äî manual verification advised";


      responseBox.style.display = "block";
    } catch (err) {
      errorBox.innerText =
        "‚ö†Ô∏è Backend is offline or waking up. Please start server on port 3001.";
      errorBox.classList.remove("hidden");
    } finally {
      loadingBox.classList.add("hidden");
      clearInterval(phaseTimer);
      phaseEl.innerText = "";

    }
  }
</script>

</body>
</html>
